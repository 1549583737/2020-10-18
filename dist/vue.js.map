{"version":3,"file":"vue.js","sources":["../observer/array.js","../observer/index.js","../src/state.js","../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/util.js","../src/vdom/index.js","../src/vdom/patch.js","../observer/schedular.js","../observer/watcher.js","../src/lifecycle.js","../src/init.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\n// oldArrayProtoMethods.push = function(){} 不能直接改写数组原有方法 不可靠，因为只有被Vue控制的数组才需要改写\n\n\nexport let arrayMethods = Object.create(Array.prototype);\n\n\nlet methods = [ // concat slice ... 都不能改变原数组\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'splice',\n    'reverse',\n    'sort'\n];\n\nmethods.forEach(method => { // AOP切片编程\n    arrayMethods[method] = function(...args) { // 重写数组方法\n        // todo ...\n        // 有可能用户新增的数据时对象格式，也需要进行拦截\n        let result =  oldArrayProtoMethods[method].call(this, ...args)\n        let inserted;\n        let ob = this.__ob__;\n        switch(method) {\n            case 'push':\n            case 'unshift':\n                    inserted = args;\n                break;\n            case 'splice': // splice(0,1,xxx)\n                 inserted = args.slice(2);\n            default: break;   \n        }\n        if (inserted) {\n            ob.observeArray(inserted)\n        };\n        ob.dep.notify();\n        // console.log('数组变化了');\n        return result;\n    }\n})","import { arrayMethods } from \"./array\";\n\nclass Observer {\n    constructor(value) { // 需要对整个value属性重新定义\n        // value可能是对象 可能是数组 分类来处理\n        // value.__obj__ = this;  这行会死循环\n\n        this.dep = new Dep(); // 给数组本身和对象本身增加一个dep属性\n        Object.defineProperty(value, '__ob__', {\n            value: this,\n            enumerable: false, // 不能被枚举表示 不能被循环\n            configurable: false, // 不能删除此属性\n        })\n\n        if (Array.isArray(value)) {\n            // push shift reverse sort 我要重写这些方法增加更新逻辑\n            // value.__proto__ = arrayMethods; // 有些浏览器不支持 __proto__写法\n            Object.setPrototypeOf(value, arrayMethods); // 循环将属性赋予上去\n            this.observeArray(value); // 原有数组中的对象   Object.freeze()\n        } else {\n            this.walk(value)\n        }\n    }\n\n    observeArray(value) {\n        for(let i = 0; i < value.length; i++) { // 如果数组中是对象的话，就回去递归观测\n            // 观测的时候会增加__ob__属性\n            observe(value[i])\n        }\n    }\n\n    walk(data) {\n        // 将对象中的所有key 重新用defineProperty定义成响应式的\n        let keys = Object.keys(data)\n        keys.forEach(key=>{\n            defineReactive(data,  key, data[key]);\n        })\n    }\n}\nfunction dependArray(value) { // 就是让里层数组收集外层数组的依赖，这样修改里层数组也可以\n    for (let i = 0; i < value.length; i++) {\n        let current = value[i];\n        current.__ob__ && current.__ob__.dep.depend();\n        if (Array.isArray(current)) {\n            dependArray(current);\n        }\n    }\n}\n\nexport function defineReactive(data, key, value) { // vue2中数据不适合嵌套过深  过深浪费性能\n    // value 可能也是一个对象\n    let childOb = observe(value); // 对结果递归拦截\n\n    let dep = new dep(); // 每次都会给属性创建一个dep\n    Object.defineProperty(data, key, { // 需要给每个属性都增加一个dep\n        get() {\n            if (Dep.target) {\n                dep.depend(); // 让这个属性自己的dep记住这个watcher，也要让watcher记住这个dep\n\n                // childOb 可能是对象 也可能是数组\n                if (childOb) { // 如果对数组取值 会将当前的watcher呵呵数组进行关联\n                    childOb.dep.depend();\n                    if (Array.isArray(value)) {\n                        dependArray(value)\n                    }\n                }\n            }\n            return value\n        },\n        set(newValue) {\n            if (newValue === value) return;\n            observe(data)\n            // data[key] = newValue; // ?\n            value = newValue;\n\n            dep.notify(); //通知dep中记录的watcher让它去执行 \n        }\n    })\n}\n\nexport function observe(data) {\n    // 只对对象类型进行观测 非对象类型无法观测\n\n    if (typeof data !== 'object' || data == null) return; // 不是对象或者是null 观测不了\n    // 通过类来对实现对数据的观测 类可以方法扩展，会产生实例\n    if(data.__ob__) { // 如果被观测过了 放弃循环引用了\n        return\n    }\n    return new Observer(data);\n}","import {observe} from '../observer/index'\n\n// vue的数据 data computed watch...\nexport function initState(vm) {\n    // 将所有数据都定义在vm属性上，并且后续更改 需要触发视图更新\n    const opts = vm.$options; // 获取用户属性\n    if (opts.data) { // 数据的初始化\n        initData(vm);\n    }\n    if (opts.props) {}\n    if (opts.methods) {}\n    if (opts.data) {}\n    if (opts.computed) {}\n    if (opts.watch) {}\n}\n\nfunction proxy(vm, source, key) { // vm.name => vm._data.name\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key];\n        },\n        set(newValue) {\n            vm[source][key] = newValue;\n        }\n    })\n}\n\nfunction initData(vm) {\n    // 数据劫持 Object.defineProperty\n    let data = vm.$options.data;\n    data = vm._data = typeof data == 'function' ? data.call(vm) : data\n\n\n    // 通过vm._data 获取劫持后的数据，用户就可以拿到_data了\n    // 将_data中的数据全部放到vm上\n    for (const key in data) {\n        proxy(vm, '_data', key);\n    }\n\n    // 观测这个数据\n    observe(data);\n}","// import { last } from \"lodash\";\n\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\nfunction genProps(attrs) {\n    console.log('attrs', attrs);\n    \n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i]; // name, value\n        if(attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item=>{\n                let [key, value] = item.split(':');\n                obj[key] = value;\n            })\n            attr.value = obj; // style: {color: red}\n        }\n        str+=`${attr.name}:${JSON.stringify(attr.value)},` // {a: 'aaa'}\n    }\n    return `{${str.slice(0,-1)}}`\n}\n\nfunction genChildren(el) {\n    const children = el.children;\n    if (children) {\n        return `${children.map(child=>gen(child)).join(',')}`\n    } else {\n        return false\n    }\n}\n\nfunction gen(node) { // 区分是元素 还是文本\n    if (node.type == 1) {\n        return generate(node);\n    } else {\n        // 文本 逻辑不能用_c来处理\n        // 有{{}}普通文本 混合文本 {{aa}} aaa {{bbb}} ccc\n        let text = node.text;\n        if (defaultStatus.test(text)) { // _v(_s(name) + 'aa' + _s(age) + '哈哈'\n            let tokens = [];\n            let match;\n            let index = 0;\n            let lastIndex = defaultTagRE.lastIndex = 0; \n            // let str = /a/g  \n            // str.test('abc')\n            // str.test('abc')\n\n            // console.log(lastIndex)\n            while(match = defaultTagRE.exec(text)) {\n                // console.log(match);\n                \n                index = match.index;\n                if (index > lastIndex) {\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n                }\n                tokens.push(`_s(${match[1].trim()})`);\n                lastIndex = index + match[0].length;\n            }\n            if (lastIndex < text.length) {\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\n            }\n            // tokens\n            return `_v(${tokens.join('+')})`\n            // 是带有{{}}\n        } else {\n            return `_v(${JSON.stringify(text)})`\n        }\n    }\n}\n\nexport function generate(el) {\n    let children = genChildren(el);\n    // console.log(children);\n    \n    // console.log(el); // 转换成render代码\n    let code = `_c('${el.tag}',${el.attrs.length?`${genProps(el.attrs)}`:'undefined'}${children ? `, ${children}`: ''})`;\n    console.log(code);\n    // let code = `_c('${el.tag}',${\n    //     el.attrs.length?`${genProps(el.attrs)}`:'undefined'\n    // }${\n    //     children? `,${children}`:''\n    // })`;\n    \n    // => js代码 html=> js代码 字符串拼接\n    return code;\n}\n\n\n/* \n\n<div>\n    <span style=\"color:red\">{{name}} <a>hello</a></span>\n</div> \n\nrender() {\n    return _c(\n        'div', {id: 'app', a:1, b:2}\n        , _c(\n            'span',\n             {style: {color: 'red'}},\n              _s(_v(name)),\n               _c(a,undefined,'hello'))\n               )\n}\n\n*/\n","// import { chartreuse } from \"color-name\";\n\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;   // aa-aa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // aa:aa 命名空间字符串\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\n\n// console.log('<div:aa>'.match(qnameCapture))\n// console.log('<div:aa>'.match(qnameCapture))\n\n\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\n\n// console.log('</div:xxx>'.match(endTag))\n\n// style=\"xxx\" style='xxx' style=xxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\n\n// console.log(`a=\"1\"`.match(attribute));\n// console.log(`a='1'`.match(attribute));\n// console.log(`a=1`.match(attribute));\n\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\n\n\n/*\n  <div>\n   <div style=\"color:red\">\n       <span>{{nae}}</span>\n   </div>\n  </div>\n*/\n\n\nexport function parseHTML(html) {\n\n    function createASTElement(tag, attrs) { // vue3里面支持多个根元素(外层加了一个空元素)，vue2中只有一个根节点\n        return {\n            tag,\n            type: 1,\n            children: [],\n            attrs,\n            parent: null\n        }\n    }\n    let root = null;\n    let currentParent;\n    let stack = [];\n\n\n\n    // 根据开始标签 结束标签 文本内容 生成ast语法树\n    function start(tagName, attrs) {\n        let element = createASTElement(tagName, attrs);\n        if (!root) {\n            root = element;\n        }\n        currentParent = element // div>span>a\n        stack.push(element);\n    }\n    function end(tagName) { // [div, div, span] 遇到span标签弹出element = span,此时栈最后一个是div即currentParent\n        let element = stack.pop();\n        currentParent = stack[stack.length -1];\n        if (currentParent) {\n            element.parent = currentParent;\n            currentParent.children.push(element)\n        }\n    }\n    function chars(text) {\n        text = text.replace(/\\s/g, '');\n        if (text) {\n            currentParent.children.push({\n                type: 3,\n                text\n            })\n        }\n    }\n\n    function advance(n) {\n        html = html.substring(n);\n    }\n\n    function parseStartTag() {\n        let start = html.match(startTagOpen);\n        if (start) {\n            let match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length); // 获取元素\n            // 查找属性\n            let end, attr;\n            // console.log(start, match)\n            // 不是开头标签结尾就一直解析\n            while(!(end=html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length); // a=1 a='1' a=\"1\"\n                // console.log(html,match);\n                match.attrs.push({name:attr[1], value: attr[3] || attr[4] || attr[5] || true})\n            }\n            if (end) {\n                advance(end[0].length);\n                return match\n            }\n        }        \n    }\n\n    while(html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd == 0) {\n            let startTagMatch = parseStartTag();\n            if (startTagMatch) { // 开始标签\n                // console.log(\"开始: \" + startTagMatch.tagName);\n                start(startTagMatch.tagName, startTagMatch.attrs);\n                continue;\n            }\n            // 结束标签\n            let endTagMatch = html.match(endTag);\n            if (endTagMatch) {\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]);\n                continue;\n                // console.log('结尾: ' + endTagMatch[1])\n            }\n            \n            // console.log(startTagMatch)\n        }\n        let text;\n        if (textEnd >= 0 ) {\n            text = html.substring(0, textEnd);\n            // console.log(\"文本: \" + text);\n        }\n        if (text) {\n            advance(text.length);\n            chars[text];\n        }\n        // break;\n    }\n    return root;\n}","\nimport {generate} from \"../compiler/generate.js\";\nimport {parseHTML} from \"../compiler/parse\";\nexport function compileToFunction(template) {\n    let ast = parseHTML(template);\n    let code = generate(ast);\n    let render = `with(this){return ${code}}`;\n    let fn = new Function(render); // 可以让字符串变成一个函数\n    console.log(fn); // eval不干净的执行\n    return fn;\n\n    // template.compiler 运行时\n    // render 编译时\n    // console.log(code);\n    // console.log(generate(root));\n}\n\n// function a() {\n//     with(this) {\n//         console.log(bb)\n//     }\n// }\n\n// a.call({bb: 66});","let callbacks = [];\nlet waiting = false;\n\nfunction flushCallbacks() {\n    for (let i = 0; i < callbacks.length; i++) {\n        let callback = callbacks[i];\n        callback();\n    }\n    waiting = false;\n    \n    // 1.promise先看支不支持\n    // 2.mutationObserver\n    // 3.setImmediate\n    // 4.setTimeout  Vue3 next-tick就直接用了promise\n}\n\n// 批处理  第一次开定时器， 后续只更新列表，之后执行清空逻辑\n\n// 1.第一次cb渲染watcher更新操作 （渲染watcher执行的过程肯定是同步的）\n// 2.第二次cb用户传入的回调\nexport function nextTick(cb) {\n    callbacks.push(cb); // 默认的cb 是渲染逻辑 用户的逻辑放到渲染逻辑之后即可\n    if(!waiting) {\n        waiting = true;\n        Promise.resolve().then(flushCallbacks)\n    }\n}\n// nextTick 肯定有异步功能\n\nexport const isObject = (val) => typeof val == 'object' && val != null\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n    'beforeMount',\n    'mounted',\n    'beforeUpdate',\n    'updated',\n    'beforeDestroy',\n    'destroyed'\n]\n\n\nconst strats = {};\n\nstrats.data = function() {}\nstrats.components = function(parentVal, childVal) {\n    const res = Object.create(parentVal);\n    if (childVal) {\n        for(let key in childVal) {\n            res[key] = childVal[key]\n        }\n    }\n    return res;\n}\n\nfunction mergeHook(parentVal, childVal) {\n    console.log(parentVal, childVal);\n    if (childVal) { // 如果\n        if (parentVal) {\n            return parentVal.concat(childVal);\n        } else { // 如果儿子有父亲没有\n            return [childVal]\n        }\n    } else {\n        return parentVal; // 儿子没有直接采用父亲\n    }\n}\n\nLIFECYCLE_HOOKS.forEach(hook => {\n    strats[hook] = mergeHook;\n})\n\nexport function mergeOptions(parent, child) {\n    const options = {};\n    // {a: 1} {a: 2} => {a: 2}\n    // {a: 1} {} => {a: 1}\n    // 自定义的策略\n    // 1.如果父亲有的儿子也有，应该用儿子替换父亲\n    // 2.如果父亲优质儿子没有，用父亲的\n    for (let key in parent) {\n        mergeField(key)\n    }\n\n    for (let key in child) {\n        if (!parent.hasOwnProperty(key)) {\n            mergeField(key);\n        }\n    }\n\n    function mergeField(key) {\n        // 策略模式\n        if (strats[key]) {\n            return options[key] = strats[key](parent[key], child[key]);\n        }\n\n\n        if (isObject(parent[key]) && isObject(child)[key]) { // 父子的值都是对象\n            options[key] = { ...parent[key], ...child[key] }\n        } else {\n            if (child[key]) { // 如果儿子有值\n                options[key] = child[key];\n            } else {\n                options[key] = parent[key];\n            }\n        }\n    }\n    return options;\n}\n\nfunction makeUp(str) {\n    const map = {\n\n    }\n    str.split(',').forEach(tagName => {\n        map[tagName] = true;\n    })\n    return (tag)=> map[tag] || false;\n}\n\nexport const isReservedTag = makeUp('a,p,div,ul,li,span,input,button')","import { isObject, isReservedTag } from \"../util\";\n\nexport function createElement(vm, tag, data={}, ...children) {\n    // 需要对标签名做过滤 因为有可能标签名是一个自定义组件\n    if (isReservedTag(tag)) {\n        return vnode(vm,tag,data,data.key,children,undefined);   \n    } else {\n        // 组件\n        const Ctor = vm.$options.components[tag]; // 对象或者函数\n        return createComponent(vm, tag, data, data.key, children, Ctor);\n    }\n}\n\n// const hook = {\n//     init (vnode) {\n\n//     }\n// }\n\nfunction createComponent(vm, tag, data, key, children, Ctor) {\n    if (isObject(Ctor)) {\n        Ctor = vm.$options._base.extend(Ctor);\n        console.log(Ctor);\n    }\n    // 给组件增加生命周期\n    data.hook = {\n        init(vnode) {\n            // 调用子组件的构造函数\n            let child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\n            child.$mount(); // 手动挂载  chid.$el = 真实的元素\n        } // 初始化狗子\n    }\n    // 组件的虚拟节点拥有hook和当前组件的componentOptions 中存放了组件的狗子函数\n    // vue-component-my-button\n    return vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, {Ctor});\n}\n\nexport  function createTextVnode(vm, text) {    \n    return vnode(vm, undefined, undefined, undefined,undefined, text)\n}\n\nexport function isSameVnode(oldVnode, newVnode) {\n    return (oldVnode.tag === newVnode.tag && oldVnode.key === newVnode.key)\n}\n\nfunction vnode(vm, tag, data, key, children, text, componentOptions) {\n    return {\n        vm,\n        tag,\n        children,\n        data,\n        key,\n        text,\n        componentOptions\n    }\n}","import { create } from \"lodash\";\nimport {isSameVnode} from './index.js'\n\nexport function patch(oldVnode, vnode) {\n    // oldVnode是一个真实的节点\n    // 1.组件oldVnode是null  $mount()\n    if (!oldVnode) {\n        return createElm(vnode); // 根据虚拟节点创建元素\n    }\n\n    \n    const isRealElement = oldVnode.nodeType;\n    if (isRealElement) {\n        // 2.初次渲染 oldVnode 是一个真实的dom\n        const oldElm = oldVnode; // id=\"app\"\n        const parentElm = oldElm.parentNode; // body\n\n        let el = createElm(vnode); // 根据虚拟节点创建真实的节点\n        parentElm.insertBefore(el, oldElm.nextSibling); // 将创建的节点插到原有的节点的下一个\n        parentElm.removeChild(oldElm);\n        return el; // vm.$el;\n    } else {\n        // 3. diff算法 两个虚拟节点的比对\n        // 1.如果两个虚拟节点的标签不一致, 那就直接替换掉就结束\n        // div=>p 标签不一样\n        if (oldVnode.tag !== vnode.tag) {\n            // 真实dom操作\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el);\n        }\n\n        // 2. 标签一样 但是是两个文本元素 {tag: undefined, text} {tag: undefined, text}\n        if (!oldVnode.tag) { // 标签相同并且是文本\n            if (oldVnode.text !== vnode.text) {\n                return oldVnode.el.textContent = vnode.text;\n            }\n        }\n\n        // 3. 元素相同, 复用老节点， 并且更新属性\n        let el = vnode.el = oldVnode.el // div div相同 复用老的真实节点\n        // 用老的属性和新的虚拟节点进行比对\n        updateProperties(vnode, oldVnode.data);\n\n        // 4.更新儿子\n        let oldChildren = oldVnode.children || [];\n        let newChildren = vnode.children || [];\n\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // 1. 老的有儿子新的也有儿子 dom-diff\n            updateChildren(el, oldChildren, newChildren);\n        } else if (oldChildren.length > 0) { // 2. 老的有儿子 新的没儿子 => 删除老儿子\n            el.innerHTML = '';\n        } else if (newChildren.length > 0) { // 3. 新的有儿子 老的没儿子 => 在老节点上面增加\n            newChildren.forEach(child => el.appendChild(createElm(child)));\n        }\n    }\n}\n\n// 1.diff算法 双指针 2.乱序怎么排序优化 \n\nfunction updateChildren(parent, oldChildren, newChildren) {\n  let oldStartIndex = 0;; // 老的头索引\n  let oldEndIndex = oldChildren.length - 1; // 老的尾索引\n  let oldStartVnode = oldChildren[0]; // 老的开始节点\n  let oldEndVnode = oldChildren[oldEndIndex]; // 老的结束节点\n\n  let newStartIndex = 0;; // 新的头索引\n  let newEndIndex = newChildren.length - 1; // 新的为索引\n  let newStartVnode = newChildren[0]; // 新的开始节点\n  let newEndVnode = newChildren[newEndIndex]; // 新的结束节点\n\n\n\n  function makeIndexByKey(oldChildren) {\n      let map = {};\n      oldChildren.forEach((item, index)=>{\n          map[item.key] = index; // [A:0,B:1,C:2]\n      });\n      return map;\n  }\n\n  let map = makeIndexByKey(oldChildren);\n\n\n\n  // 越界了就不用比较了\n   while(oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n     // 1.前端中比较常见的操作有 向尾部插入 头部插入 头移动到尾部 尾部移动头部， 正序和反序\n     // 1) 向后插入操作\n     if(!oldStartVnode) {\n         oldStartVnode = oldChildren[++oldStartIndex];\n     } else if (!oldEndVnode) { // 最后一个往前以移动可能是undefined不存在\n         oldEndVnode = oldChildren[--oldEndIndex];\n     } else if (isSameVnode(oldStartVnode, newStartVnode)) {  // 头和头比对\n         patch(oldStartVnode, newStartVnode); // 递归比对节点\n         oldStartVnode = oldChildren[++oldStartIndex];\n         newStartVnode = newChildren[++newStartIndex];\n     } else if (isSameVnode(oldEndVnode, newEndVnode)) { // 尾和尾比对\n         patch(oldEndVnode, newEndVnode);\n         oldEndVnode = oldChildren[--oldEndIndex];\n         newEndVnode = newChildren[--newEndIndex]\n     } else if (isSameVnode(oldStartVnode, newEndVnode)) { // \n         patch(oldStartVnode, newEndVnode);\n         // dom 操作时具备移动性的 会移动\n         parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling);\n         oldStartVnode = oldChildren[++oldStartIndex];\n         newEndVnode = newChildren[--newEndIndex];\n     } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n         patch(oldEndVnode, newStartVnode);\n         parent.insertBefore(oldEndVnode.el, oldStartVnode.el);\n         oldEndVnode = oldChildren[--oldEndIndex];\n         newStartVnode = newChildren[++newStartIndex];\n     } else {\n         // 1.需要先查找当前 老节点索引和key的关系\n         // 移动的时候通过新的key 去找对应的老节点索引 => 获取老节点， 可以移动老节点\n\n         let moveIndex = map[newStartVnode.key];\n         if (moveIndex == undefined) {\n             parent.insertBefore(createElm(newStartVnode), oldStartVnode.el);\n         } else {\n             let moveVnode = oldChildren[moveIndex];\n             oldChildren[moveIndex] = undefined;\n             patch(moveVnode, newStartVnode); // 如果找到了 需要两个虚拟节点比对\n             parent.insertBefore(moveVnode.el, oldStartVnode.el);\n         }\n         newStartVnode = newChildren[++newStartIndex]\n     }\n     // 2) 向前插入操作\n     // 为什么key不建议用index 为什么v-for要增加key 属性\n\n   }\n\n   // 头指针和尾指针重合\n   if (newStartIndex <= newEndIndex) {\n    for (let i = newStartIndex; i < newEndIndex; i++) { // 新的比老的多， 插入新节点\n        // 向前插入 向后插入\n        // 看一眼newEndIndex 下一个节点有没有值\n        let nextEle = newChildren[newEndIndex+1] == null ? null :  newChildren[newEndIndex+1].el;\n        // appendChild和insertBefore也可以进行合并\n        // 如果insertBefore传入null 等价于 appendChild\n        parent.insertBefore(createElm(newChildren[i], nextEle));\n\n        // parent.appendChild(createElm(newChildren[i]));\n    }\n}\nif (oldStartIndex <= oldEndIndex) {\n    for (let i = oldStartIndex; i < oldEndIndex; i++) {\n        let child = oldChildren[i];\n        if(child != undefined) {\n            parent.removeChild(child.el); // 用父亲移除儿子即可\n        }\n    }\n}\n}\n\nfunction updateProperties(vnode, oldProps = {}) {\n    let newProps = vnode.data || {}; // 属性\n    let el = vnode.el; // dom元素\n    \n    // 1. 老的属性 新的没有 删除属性\n    for (let key in oldProps) {\n        if (!newProps[key]) {\n            el.removeAttribute(key);\n        }\n    }\n\n    let newStyle = newProps.style || {}; // {color: red}\n    let oldStyle = oldProps.style || {}; // {background: red}\n    console.log(newStyle, oldStyle);\n    for(let key in oldStyle) { // 判断样式根据 新老先比对一下\n        if (!newStyle[key]) {\n            el.style[key] = ''\n        }\n    }\n\n\n    // 2. 新的属性 老的没有, 直接用新的覆盖 不考虑有没有\n\n\n    for(let key in newProps) {\n        if (key === 'style') {\n            for(let styleName in newProps.style) {\n                el.style[styleName] = newProps.style[styleName];\n            }\n        } else if (key === 'class') {\n            el.className = newProps.class;\n        } else {\n            el.setAttribute(key, newProps[key]);\n        }\n    }\n}\n\nfunction createComponent(vnode) {\n    let i = vnode.data;\n    // i = vnode.data.hook\n    // i = i.init\n    if ((i=i.hook) && (i = i.init)) {\n        i(vnode); // 调用组件的初始化方法 // vnode.componentInstance.$el\n    }\n    if (vnode.componentInstance) { // 如果虚拟节点上有\n        return true\n    }\n    return false;\n}\n\nexport function createElm(vnode) { // 根据虚拟节点创建真实的节点\n    let { tag, children, key, data, text, vm } = vnode;\n    if (typeof tag === 'string') { // 两种可能 可能是一个组件\n        // 可能是组件, 如果是组件 就直接根据组件创建出组件对应的真实节点\n        if (createComponent(vnode)) {\n            // 如果返回true 说明这个虚拟节点是组件\n            // 如果是组件，就将组件渲染后的真实元素给我\n            return vnode.componentInstance.$el;\n        }\n        \n        vnode.el = document.createElement(tag); // 用Vue的指令时可以通过vnode拿到真实dom\n        updateProperties(vnode);\n        children.forEach(child => { // 如果有儿子节点，就进行递归操作\n            vnode.el.appendChild(createElm(child));\n        })\n    } else {\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el;\n}\n\n","import {nextTick} from '../src/util.js'\n\nlet has = {};\nlet queue = [];\n// 多次调用queueWatcher 如果watcher不是同一个\nlet pending = false;\n\nfunction flushSchedularQueue() {\n    for (let i = 0; i < queue.length; i++) {\n        let watcher = queue[i];\n        watcher.run();\n    }\n    queue = [];\n    has = {};\n    pending = false;\n}\n\nexport function queueWatcher(watcher) { // 调度更新几次\n    // 更新时对watcher进行去重操作\n    let id = watcher.id;\n    if(has[id] == null) { // 没有id\n        queue.push(watcher);\n        has[id] = true;\n        console.log(queue);\n\n        // 让queue清空\n        if (!pending) {\n            pending = true;\n            nextTick(flushSchedularQueue);\n        }\n        // setTimeout(flushSchedularQueue, 0)\n    }\n}    ","import { popTarget, pushTarget } from \"./dep\";\nimport {queueWatcher} from '../observer/schedular.js'\nlet id = 0;\n\nclass Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.vm = vm;\n        this.cb = cb;\n        this.options = options;\n        let id = id++;\n        this.deps = [];\n        this.depsId = new Set();\n        this.getter = exprOrFn //调用传入的函数, 调用了render方法，此时会对模板中的数据取值\n        this.get();\n        \n    }\n\n    // 这个方法中会对属性进行取值操作\n    get() {\n        pushTarget(this); // Dep.target = watcher\n        this.getter(); // 会取值 vm_update(vm_render())\n        popTarget(); // Dep.target = null\n    }\n\n    addDep(dep) {\n        let id = dep.id;\n        if (!this.depsId.has(id)) { // dep是非重复的，watcher肯定也不会重\n            this.depsId.add(id);\n            this.deps.push(dep);\n            dep.addSub(this);\n        }\n    }\n\n    run() {\n        this.get();\n    }\n\n    update() { // 如果多次更改 我希望合并成一次 (防抖)\n        this.get(); // 不停地渲染\n        queueWatcher(this);\n    }\n            // 当属性取值时  需要记住这个watcher 稍后数据变化了，去执行自己记住的watcher即可\n}\n    \n\nexport default Watcher;","import { patch } from \"./vdom/patch\";\nimport Watcher from '../observer/watcher'\n\nexport function lifecycleMixin(Vue) {\n    Vue.prototype._update = function(vnode) {\n        // 将虚拟节点转换成真实的dom\n        const vm = this;\n        // 首次渲染 需要用虚拟节点 来更新真实的dom\n\n        // 初始化渲染的时候 会创建一个新节点并且将老节点删除\n\n        // 1.第一次渲染完毕后 拿到新的节点，下次渲染时替换上次渲染的结果\n\n        // 第一次初始化 第二次走diff算法\n        const prevVnode = vm._vnode; // 先取上一次的vnode 看下一次是否有\n        vm._vnode = vnode;  // 保存上一次的虚拟节点\n        if (!prevVnode) {\n            vm.$el = patch(vm.$el, vnode); // 组件调用patch方法后会产生$el属性    \n        } else {\n            vm.$el = patch(prevVnode, vnode);\n        }\n        \n        // console.log('update', vnode)\n    }\n}\n\nexport function callHook(vm, hook) {\n    const handlers = vm.$options[hook];\n    if (handlers) {\n        handlers.forEach(handler => handlers.call(vm));\n    }\n}\n\nexport function mountComponent(vm, el) {\n    console.log(vm, el);\n    // 默认Vue是通过watcher来进行渲染  = 渲染watcher （每一个组件都有一个渲染watcher）\n    let updateComponent = () => {\n        vm._update(vm._render()); // 把虚拟节点渲染成真正的节点\n    }\n    new Watcher(vm, updateComponent, ()=>{ }, true) // updateComponent();\n}","import {initState} from './state'\nimport {compileToFunction} from './compiler/index.js'\nimport { mountComponent, callHook} from './lifecycle';\nimport { mergeOptions, nextTick} from './util';\nimport { call } from 'function-bind';\nexport function initMixin(Vue) {\n    Vue.prototype._init = function(options) {\n       const vm = this;\n    //    vm.$options = options; // 实例中有个属性$options 表示的是用户传入的所有属性\n    // vm.constructor可能指向的是儿子类 不一定是Vue\n       vm.$options = mergeOptions(vm.constructor.options, options);\n       console.log(vm.$options);\n       // 初始化状态\n       callHook(vm, 'beforeCreate');\n       initState(vm);\n       callHook(vm, 'created');\n        console.log('666');\n       if (vm.$options.el) { // 数据可以挂载到页面上\n          vm.$mount(vm.$options.el);\n       }\n    }\n\n    Vue.prototype.$nextTick = nextTick\n\n    Vue.prototype.$mount = function(el) {\n        console.log('进来了');\n        el = document.querySelector(el);\n\n        const vm = this;\n        const options = vm.$options;\n        vm.$el = el;\n        // 如果有render 就直接使用render\n        // 没有render 看有没有template属性\n        // 没有template 就接着找外部模板\n        if (!options.render) {\n            let template = options.template;\n            if (!template && el) {\n                template = el.outerHTML // 火狐不兼容 document.createElement('div').appendChild('app').innerHTML\n            }\n            // console.log(template);\n            // 如何将模板编译成render函数\n            const render = compileToFunction(template);\n            options.render = render;\n            console.log(options.render);\n        }\n        mountComponent(vm, el);\n    }\n   \n}\n\n\n","import { createElement, createTextVnode } from \"./vdom/index\";\n\nexport function renderMixin(Vue) {\n    Vue.prototype._c = function(...args) { // 创建元素的虚拟节点\n        return createElement(this, ...args);\n    }   \n    Vue.prototype._v = function(text) { // 创建文本的虚拟节点\n        return createTextVnode(this, text);\n    }\n    Vue.prototype._s = function(value) { // 转化成字符串\n        return val  == null ? '' : (typeof val == 'object') ? JSON.stringify(val): val;\n    }\n\n    Vue.prototype._render = function() {\n        // render\n        const vm = this;\n        let render = vm.$options.render; // 获取编译后的render方法\n        let vnode = render.call(vm); // _(xxx,xxx,xxx,xxx) 调用时会自动将变量进行取值，将实例结果进行渲染\n        return vnode; // 虚拟节点\n\n        // _c('div',{},_c())\n    }\n}\n\n\n","import {mergeOptions} from '../util'\n\nexport function initGlobalAPI(Vue) {\n    Vue.options = {}; // 用来存储全局的配置\n    // filter directive component\n    Vue.mixin = function (mixin) {\n        // mergeOptions\n        this.options = mergeOptions(this.options, mixin);\n        console.log(this.options);\n        return this;\n    }\n\n    // this.options_base 表示父类的不是子类的this\n\n    Vue.options._base = Vue; // Vue的构造函数 后面会用到\n    Vue.options.components= {}; // 用来存放组件的定义\n    Vue.component = function (id, definition) {\n        definition.name = definition.name || id;\n        definition = this.options._base.extend(definition); // 通过对象产生一个构造函数\n        this.options.components[id] = definition;\n        console.log(this.options);\n    }\n    let cid = 0; // 防止不同的构造函数名字相同\n    Vue.extend = function(options) { // 子组件初始化时会 new VueComponent(options)\n        const Super = this;\n        // 产生一个子组件\n\n        const Sub = function VueComponent(options) {\n            this._init(options)\n        }\n        Sub.cid = cid ++;//防止不同的构造函数名字相同\n        Sub.prototype = Object.create(Super.prototype); // 都是通过Vue继承来的\n        Sub.prototype.constructor = Sub; // 继承\n        Sub.component = Super.component;\n\n        // ... 每次声明一个组件 都会把父级的定义放在自己的身上\n        Sub.options = mergeOptions(Super.options, options);\n        return Sub; // 这个构造函数是由对象产生而来的\n    }\n\n    // Sub.component();\n}\n\n","// Vue2.0中就是一个构造函数 class\nimport {initMixin} from './init'\nimport {lifecycleMixin} from './lifecycle'\nimport {renderMixin} from './render'\nimport {initGlobalAPI} from './global-api/index'\nimport { compileToFunction } from './compiler/index';\nimport {createElm, patch} from './vdom/patch'\nfunction Vue(options) {\n    this._init(options); //当用户 new Vue时，就调用init方法进行vue的初始化方法\n}\n\ninitMixin(Vue);\nlifecycleMixin(Vue); // 扩展update方法 更新逻辑\nrenderMixin(Vue); // 扩展_render方法，调用render方法的逻辑\n// 可以拆分逻辑到不同的文件中  更利于代码维护 模块化的概念\n\ninitGlobalAPI(Vue) // 混合全局的API\n\n\n// 我们自己构建两个虚拟dom, 之后手动进行比对\n\nlet vm1 = new Vue({data(){return {name: 'zf'}}});\n// 将模板变成render函数\nlet render1 = compileToFunction(`<div id=\"a\" a=\"1\" style=\"color: red\">{{name}}</div>`) // 将模板编译成render函数\nlet render3 = compileToFunction(\n    `\n    <ul>\n    <li key=\"A\">A</li>\n    <li key=\"B\">B</li>\n    <li key=\"C\">C</li>\n    <li key=\"D\">D</li>\n</ul>\n    `\n)\n\nlet oldVnode = render1.call(vm1); // 老的虚拟节点\nlet el = createElm(oldVnode);\ndocument.body.appendChild(el);\n\nlet vm2 = new Vue({\n    data() {\n        return {name: 'jw'}\n    }\n})\nlet render2 = compileToFunction(`<div id=\"b\" b=\"1\" style=\"background: red\">{{name}}</div>`);\nlet render4 = compileToFunction(\n    `\n        <ul>\n            <li key=\"A\">A</li>\n            <li key=\"B\">B</li>\n            <li key=\"C\">C</li>\n            <li key=\"D\">D</li>\n            <li key=\"E\">E</li>\n        </ul>\n    `\n)\nlet newVnode = render2.call(vm2);\nlet el1 = createElm(newVnode);\ndocument.body.appendChild(el1);\n\npatch(oldVnode, newVnode); // 包括了初始渲染和diff算法的原理\nexport default Vue\n\n// 库 => rollup 项目开发 webpack"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","call","inserted","ob","__ob__","slice","observeArray","dep","notify","Observer","value","Dep","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","i","length","observe","data","keys","key","defineReactive","dependArray","current","depend","childOb","get","target","set","newValue","initState","vm","opts","$options","initData","props","computed","watch","proxy","source","_data","defaultTagRE","genProps","attrs","console","log","str","attr","name","obj","split","item","JSON","stringify","genChildren","el","children","map","child","gen","join","node","type","generate","text","defaultStatus","test","tokens","match","index","lastIndex","exec","push","trim","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","parent","root","currentParent","stack","start","tagName","element","end","pop","advance","n","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","template","ast","render","fn","Function","callbacks","waiting","flushCallbacks","callback","nextTick","cb","Promise","resolve","then","isObject","val","LIFECYCLE_HOOKS","strats","components","parentVal","childVal","res","mergeHook","concat","hook","mergeOptions","options","mergeField","hasOwnProperty","makeUp","isReservedTag","createElement","vnode","undefined","Ctor","createComponent","_base","extend","init","componentInstance","componentOptions","$mount","cid","createTextVnode","isSameVnode","oldVnode","newVnode","patch","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","newStartIndex","newEndIndex","newStartVnode","newEndVnode","makeIndexByKey","moveIndex","moveVnode","nextEle","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleName","className","setAttribute","$el","document","createTextNode","has","queue","pending","flushSchedularQueue","watcher","run","queueWatcher","id","Watcher","exprOrFn","deps","depsId","Set","getter","add","addSub","lifecycleMixin","Vue","_update","prevVnode","_vnode","callHook","handlers","handler","mountComponent","updateComponent","_render","initMixin","_init","constructor","$nextTick","querySelector","outerHTML","renderMixin","_c","_v","_s","initGlobalAPI","mixin","component","definition","Super","Sub","VueComponent","vm1","render1","render3","body","vm2","render2","render4","el1"],"mappings":"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"}